(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{426:function(e,t,n){"use strict";n.r(t);var o=n(1),i=n.n(o),a={data:function(){return{snackbar:!1,isError:!1,message:"",incomeselections:[],editedIncome:{id:null,title:"",description:"",amount:"",land_id:null,user_id:null,received_at:null},dateMenu:!1,viewIncome:{},editedIndex:0,incomeId:null,dialogIncome:!1,itemsPerPage:10,footerprops:{"items-per-page-options":[5,10,15,100]},search:"",selected:[],showSelect:!0,totalIncomes:0,incomes:[],loading:!0,options:{},headers:[{text:this.$t("form.title"),align:"left",sortable:!0,value:"title"},{text:this.$t("form.description"),value:"description",sortable:!1},{text:this.$t("form.amount"),value:"amount",sortable:!1},{text:this.$t("form.received_at"),value:"received_at",sortable:!1},{text:this.$t("form.actions"),value:"action",sortable:!1}]}},watch:{options:{handler:function(){var e=this;this.fetchIncomeFromServer().then((function(t){e.incomes=t.items,e.totalIncomes=t.total}))},deep:!0}},methods:{fetchIncomeFromServer:function(){var e=this;this.loading=!0;var t="/api/incomes/";return"number"==typeof this.options.itemsPerPage&&(t+="?paginate=".concat(this.options.itemsPerPage),this.options.page&&(console.log("page ".concat(this.options.page)),t+="&&page=".concat(this.options.page))),void 0!==this.options.sortBy[0]&&(t+="&&sortBy=".concat(this.options.sortBy[0])),this.options.sortDesc.length>0&&(console.log(this.options.sortDesc),t+="&&sortDesc=".concat(this.options.sortDesc[0])),void 0!==this.search[0]&&(t="/api/incomes/?search=".concat(this.search)),console.log("loaded"),new Promise((function(n,o){axios.get(t).then((function(t){var o=e.options,i=(o.sortBy,o.sortDesc,o.page,o.itemsPerPage,[]);void 0!==t.data.data&&(i=t.data.data);var a=0;void 0!==t.data.meta?(a=t.data.meta.total,e.footerprops["items-per-page-options"]=[5,10,15,100,a]):(a=t.data.data.length,e.footerprops["items-per-page-options"]=[a]),e.loading=!1,n({items:i,total:a})})).catch((function(e){console.log(e),o(e)}))}))},initIncome:function(){this.editedIncome={id:null,title:"",description:"",amount:"",land_id:null,user_id:null,received_at:null},this.viewIncome={},this.incomeId=null,this.dialogIncome=!0,this.fetchIncomeSelections()},onSaveIncome:function(){var e=this,t=this.editedIncome,n={title:t.title,description:t.description,amount:t.amount,land_id:t.land_id,user_id:t.user_id,received_at:t.received_at};null==this.incomeId?axios.post("/api/incomes",n).then((function(t){e.incomes.push(t.data.data),e.snackbar=!0,e.isError=!1,e.message=e.$t("incomes.created")})).catch((function(t){e.snackbar=!0,e.isError=!0,e.message=t.response.data.message})):axios.put("/api/incomes/".concat(this.incomeId),n).then((function(t){Object.assign(e.incomes[e.editedIndex],t.data.data),e.snackbar=!0,e.isError=!1,e.message=e.$t("incomes.updated")})).catch((function(t){console.log(t.response),e.snackbar=!0,e.isError=!0,e.message=t.response.data.message})),this.dialogIncome=!1},deleteItem:function(e){var t=this,n=this.incomes.indexOf(e);confirm("Are you sure you want to delete this income?")&&axios.delete("/api/incomes/".concat(e.id)).then((function(e){t.incomes.splice(n,1),t.snackbar=!0,t.isError=!1,t.message=t.$t("incomes.deleted")})).catch((function(e){t.snackbar=!0,t.isError=!0,t.message=e.response.data.message})),console.log(e)},onSearchIncome:function(){var e=this;this.fetchIncomeFromServer().then((function(t){e.incomes=t.items,e.totalIncomes=t.total}))},onCancelSearch:function(){var e=this;this.search="",this.fetchIncomeFromServer().then((function(t){e.incomes=t.items,e.totalIncomes=t.total}))},cancel:function(){this.dialogIncome=!1,this.initIncome(),console.log("canceled")},close:function(){this.dialogIncome=!1,console.log("closed")},editItem:function(e){this.editedIndex=this.incomes.indexOf(e),this.incomeId=e.id;var t=e;t.received_at=i()(t.received_at).format("YYYY-MM-DD"),this.editedIncome=Object.assign({},t),this.dialogIncome=!0,console.log(e),this.fetchIncomeSelections()},fetchIncomeSelections:function(){var e=this;axios.get("/api/users/selections").then((function(t){console.log(t),e.incomeselections=t.data})).catch((function(e){console.log(e)}))}}},s=n(6),c=n(13),r=n.n(c),l=n(430),d=n(63),m=n(96),v=n(4),u=n(431),p=n(432),h=n(418),f=n(417),_=n(412),g=n(102),I=n(90),b=n(99),k=n(64),x=n(5),y=n(58),V=n(104),w=n(433),$=n(50),S=n(434),C=n(435),D=n(47),E=n(25),P=n(19),M=Object(s.a)(a,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",{staticClass:"px-3"},[n("v-row",[n("v-col",{attrs:{cols:"12",lg:"9"}},[n("v-card",{staticClass:"border-top border-primary"},[n("v-data-table",{attrs:{headers:e.headers,items:e.incomes,options:e.options,"server-items-length":e.totalIncomes,loading:e.loading,"items-per-page":e.itemsPerPage,"footer-props":e.footerprops,"show-select":e.showSelect,"loading-text":"Loading... Please wait"},on:{"update:options":function(t){e.options=t}},scopedSlots:e._u([{key:"top",fn:function(){return[n("v-toolbar",{attrs:{color:"white",flat:""}},[n("v-toolbar-title",[n("v-icon",{attrs:{size:45}},[e._v("\n                                    mdi-account-multiple\n                                ")]),e._v("\n                                "+e._s(e.$t("income"))+"\n                            ")],1),e._v(" "),n("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),e._v(" "),n("v-spacer"),e._v(" "),n("v-btn",{staticClass:"mb-2",attrs:{color:"primary",rounded:"",dark:""},on:{click:e.initIncome}},[n("v-icon",[e._v("mdi-plus")]),e._v("\n                                "+e._s(e.$t("New Income")))],1),e._v(" "),n("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialogIncome,callback:function(t){e.dialogIncome=t},expression:"dialogIncome"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline"},[e._v(e._s(null!=e.editedIncome.id?e.$t("Edit Income"):e.$t("New Income")))])]),e._v(" "),n("v-card-text",[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[n("v-text-field",{attrs:{label:e.$t("form.title")},model:{value:e.editedIncome.title,callback:function(t){e.$set(e.editedIncome,"title",t)},expression:"\n                                                            editedIncome.title\n                                                        "}})],1),e._v(" "),n("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[n("v-text-field",{attrs:{label:e.$t("form.description")},model:{value:e.editedIncome.description,callback:function(t){e.$set(e.editedIncome,"description",t)},expression:"\n                                                            editedIncome.description\n                                                        "}})],1),e._v(" "),n("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[n("v-text-field",{attrs:{type:"number",label:e.$t("form.amount")},model:{value:e.editedIncome.amount,callback:function(t){e.$set(e.editedIncome,"amount",t)},expression:"\n                                                            editedIncome.amount\n                                                        "}})],1),e._v(" "),n("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[n("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on;return[n("v-text-field",e._g({attrs:{"prepend-inner-icon":"mdi-calendar-check",label:e.$t("Date"),readonly:""},model:{value:e.editedIncome.received_at,callback:function(t){e.$set(e.editedIncome,"received_at",t)},expression:"\n                                                                    editedIncome.received_at\n                                                                "}},o))]}}]),model:{value:e.dateMenu,callback:function(t){e.dateMenu=t},expression:"dateMenu"}},[e._v(" "),n("v-date-picker",{on:{input:function(t){e.dateMenu=!1}},model:{value:e.editedIncome.received_at,callback:function(t){e.$set(e.editedIncome,"received_at",t)},expression:"\n                                                                editedIncome.received_at\n                                                            "}})],1)],1)],1)],1)],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.close}},[e._v(e._s(e.$t("form.cancel")))]),e._v(" "),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.onSaveIncome}},[e._v(e._s(e.$t("form.save")))])],1)],1)],1),e._v(" "),n("v-menu",{attrs:{"offset-y":"",bottom:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on;return[n("v-btn",e._g({attrs:{icon:""}},o),[n("v-icon",[e._v("\n                                            mdi-menu-down\n                                        ")])],1)]}}])},[e._v(" "),n("v-list",[n("v-list-item",{attrs:{dense:""}},[n("v-list-item-icon",[n("v-icon",[e._v("\n                                                mdi-file-excel-outline\n                                            ")])],1),e._v(" "),n("v-list-item-content",{attrs:{left:""}},[n("v-list-item-title",[e._v("\n                                                Exports Excel\n                                            ")])],1)],1)],1)],1)],1),e._v(" "),n("v-col",{attrs:{cols:"12",sm:"12",md:"4"}},[n("v-text-field",{attrs:{label:"Search","single-line":""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearchIncome(t)}},scopedSlots:e._u([{key:"append",fn:function(){return[""!=e.search?n("v-btn",{staticClass:"pa-0 ma-0",attrs:{small:"",icon:""},on:{click:e.onCancelSearch}},[n("v-icon",[e._v("mdi-close")])],1):e._e(),e._v(" "),n("v-btn",{staticClass:"pa-0 ma-0",attrs:{small:"",icon:""},on:{click:e.onSearchIncome}},[n("v-icon",[e._v(" mdi-crosshairs ")])],1)]},proxy:!0}]),model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)]},proxy:!0},{key:"item.selected",fn:function(t){var o=t.item;return[n("v-simple-checkbox",{attrs:{color:"green"},model:{value:o.selected,callback:function(t){e.$set(o,"selected",t)},expression:"item.selected"}})]}},{key:"item.received_at",fn:function(t){var o=t.item;return[n("span",[e._v(e._s(e.moment(o.received_at).format("DD-MMM-Y")))])]}},{key:"item.amount",fn:function(t){var o=t.item;return[n("span",{staticClass:"green--text font-weight-bold"},[n("v-icon",{attrs:{size:15}},[e._v(" mdi-currency-usd ")]),e._v(" "+e._s(o.amount))],1)]}},{key:"item.action",fn:function(t){var o=t.item;return[n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(o)}}},[e._v("\n                            mdi-pencil\n                        ")]),e._v(" "),n("v-icon",{attrs:{small:""},on:{click:function(t){return e.deleteItem(o)}}},[e._v("\n                            mdi-trash-can-outline\n                        ")])]}},{key:"item.name",fn:function(t){var o=t.item;return[n("v-icon",{staticClass:"mr-5",attrs:{color:"primary"}},[e._v("\n                            mdi-account-circle-outline\n                        ")]),e._v(" "),n("span",{staticClass:"caption"},[e._v(e._s(o.name))])]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)],1)],1),e._v(" "),n("v-snackbar",{attrs:{color:e.isError?"error":"success"},model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v("\n        "+e._s(e.message)+"\n        "),n("v-spacer"),e._v(" "),n("v-btn",{attrs:{text:""},on:{click:function(t){e.snackbar=!e.snackbar}}},[e._v("close")])],1)],1)}),[],!1,null,null,null);t.default=M.exports;r()(M,{VApp:l.a,VBtn:d.a,VCard:m.a,VCardActions:v.a,VCardText:v.b,VCardTitle:v.c,VCol:u.a,VContainer:p.a,VDataTable:h.a,VDatePicker:f.a,VDialog:_.a,VDivider:g.a,VIcon:I.a,VList:b.a,VListItem:k.a,VListItemContent:x.a,VListItemIcon:y.a,VListItemTitle:x.c,VMenu:V.a,VRow:w.a,VSimpleCheckbox:$.a,VSnackbar:S.a,VSpacer:C.a,VTextField:D.a,VToolbar:E.a,VToolbarTitle:P.a})}}]);